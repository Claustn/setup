function Install-VisualStudioProfessional([string]$configFileName) {
    $components = @(
        "Microsoft.VisualStudio.Component.CoreEditor",
        "Microsoft.VisualStudio.Workload.CoreEditor",
        "Microsoft.VisualStudio.Component.Roslyn.Compiler",
        "Microsoft.Component.MSBuild",
        "Microsoft.VisualStudio.Component.Roslyn.LanguageServices",
        "Microsoft.Net.Component.4.7.2.SDK",
        "Microsoft.Net.Component.4.7.2.TargetingPack",
        "Microsoft.Net.ComponentGroup.DevelopmentPrerequisites",
        "Microsoft.VisualStudio.Component.SQL.CLR",
        "Microsoft.VisualStudio.Component.TextTemplating",
        "Microsoft.VisualStudio.Component.ManagedDesktop.Core",
        "Microsoft.Net.Core.Component.SDK.2.1",
        "Microsoft.VisualStudio.Component.ManagedDesktop.Prerequisites",
        "Microsoft.Net.Component.4.TargetingPack",
        "Microsoft.Net.Component.4.5.TargetingPack",
        "Microsoft.Net.Component.4.5.1.TargetingPack",
        "Microsoft.Net.Component.4.5.2.TargetingPack",
        "Microsoft.Net.Component.4.6.TargetingPack",
        "Microsoft.Net.ComponentGroup.TargetingPacks.Common",
        "Microsoft.VisualStudio.Component.Debugger.JustInTime",
        "Microsoft.VisualStudio.Component.NuGet",
        "Microsoft.Net.Component.4.6.1.TargetingPack",
        "Microsoft.VisualStudio.Component.FSharp.Desktop",
        "Microsoft.VisualStudio.Component.FSharp",
        "Microsoft.NetCore.ComponentGroup.DevelopmentTools.2.1",
        "Microsoft.Net.Component.4.6.1.SDK",
        "Microsoft.VisualStudio.Component.IISExpress",
        "Microsoft.VisualStudio.Component.TypeScript.3.3",
        "Microsoft.VisualStudio.ComponentGroup.WebToolsExtensions",
        "Microsoft.VisualStudio.Component.JavaScript.TypeScript",
        "Microsoft.VisualStudio.Component.JavaScript.Diagnostics",
        "Component.Microsoft.VisualStudio.RazorExtension",
        "Microsoft.VisualStudio.Component.SQL.ADAL",
        "Microsoft.VisualStudio.Component.SQL.LocalDB.Runtime",
        "Microsoft.VisualStudio.Component.Common.Azure.Tools",
        "Microsoft.VisualStudio.Component.MSODBC.SQL",
        "Microsoft.VisualStudio.Component.MSSQL.CMDLnUtils",
        "Microsoft.VisualStudio.Component.SQL.SSDT",
        "Microsoft.VisualStudio.Component.SQL.DataSources",
        "Component.Microsoft.Web.LibraryManager",
        "Microsoft.VisualStudio.ComponentGroup.Web",
        "Microsoft.VisualStudio.Component.DockerTools",
        "Microsoft.VisualStudio.Workload.ManagedDesktop",
        "Microsoft.VisualStudio.Component.VC.CoreIde",
        "Microsoft.VisualStudio.Component.VC.Redist.14.Latest",
        "Microsoft.VisualStudio.ComponentGroup.NativeDesktop.Core",
        "Microsoft.VisualStudio.Component.VC.Tools.x86.x64",
        "Microsoft.VisualStudio.Component.Windows10SDK.17763",
        "Microsoft.VisualStudio.Component.Graphics.Tools",
        "Microsoft.VisualStudio.Component.VC.DiagnosticTools",
        "Microsoft.VisualStudio.Component.VC.CMake.Project",
        "Microsoft.VisualStudio.Component.VC.ATL",
        "Microsoft.VisualStudio.Component.VC.TestAdapterForGoogleTest",
        "Microsoft.VisualStudio.Component.VC.CLI.Support",
        "Microsoft.VisualStudio.Component.VC.v141.x86.x64",
        "Microsoft.VisualStudio.Workload.NativeDesktop",
        "Microsoft.VisualStudio.Component.DiagnosticTools",
        "Microsoft.VisualStudio.Component.FSharp.WebTemplates",
        "Microsoft.NetCore.ComponentGroup.Web.2.1",
        "Microsoft.VisualStudio.Component.Windows10SDK",
        "Microsoft.VisualStudio.Workload.NativeGame",
        "Component.MDD.Linux",
        "Component.Linux.CMake",
        "Microsoft.VisualStudio.Workload.NativeCrossPlat",
        "Microsoft.VisualStudio.Workload.NetCoreTools",
        "Microsoft.VisualStudio.Component.VC.v141.CLI.Support"
    )
    
    & ./installers/vs_professional.exe --wait --passive --norestart ($components | ForEach-Object { @("--add", $_) })
}